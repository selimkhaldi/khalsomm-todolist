/**
 * Copyright (c) 2016 Sqreen. All Rights Reserved.
 * Please refer to our terms for more information: https://www.sqreen.io/terms.html
 */
'use strict';
const Code = require('code');
const Lab = require('lab');
const lab = exports.lab = Lab.script();

const describe = lab.describe;
const it = lab.it;
const expect = Code.expect;

const WAP = require('../../../lib/backend/wreckAsPromised');

const defaultHeaders = {
    accept: 'application/json',
    'content-type': 'application/json'
};

describe('WAP', () => {

    describe('_writeError', () => {

        it('should write errors', { plan: 2 }, (done) => {

            expect(WAP._writeError(500).code).to.equal('Internal Server Error');
            expect(WAP._writeError(1492).code).to.equal(1492);
            done();
        });
    });

    describe('_assignHeaders', () => {

        it('should assign headers', { plan: 2 }, (done) => {

            expect(WAP._assignHeaders({})).to.equal(defaultHeaders);
            const aaHeaders = defaultHeaders;
            aaHeaders.X = 'aa';
            expect(WAP._assignHeaders({ headers: { X: 'aa' } })).to.equal(aaHeaders);
            done();
        });

    });

});
