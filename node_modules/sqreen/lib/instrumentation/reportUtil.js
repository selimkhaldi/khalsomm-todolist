/**
 * Copyright (c) 2016 Sqreen. All Rights Reserved.
 * Please refer to our terms for more information: https://www.sqreen.io/terms.html
 */
'use strict';
module.exports.mapRequest = function (req) {

    req.headers = req.headers || {};

    return {
        rid: '',
        user_agent: req.headers['user-agent'],
        scheme: 'http',
        verb: req.method,
        host: req.headers.host,
        port: req.headers.host && req.headers.host.split(':').pop(),
        rport: req.connection && req.connection.remotePort,
        path: req.url,
        addr: req.headers['x-forwarded-for'] || req.connection && req.connection.remoteAddress
    };
};
